<!DOCTYPE html>
<html>
	<head>
<title>Tech Buffer</title>
<link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.no-icons.min.css" rel="stylesheet">
<link rel="stylesheet" href="style.css">
	</head>
	<body>
<section class="container">

	<h2>Tech Buffer</h2>


<input type="search" class="light-table-filter" data-table="order-table" placeholder="Enter Tech#" /><br>
<form name="input-form" id="myForm" method="POST" netlify>
  <input type="hidden" name="cpeData" class="myInput" />
<input class="btn btn-primary" type="button" value="Submit" onclick='myFunc();'>

  <table class="order-table">
		<thead>
			<tr>
				<th>ID</th>
				<th>Employee</th>
				<th>Description</th>
				<th>Serial#</th>
				<th>Days Aged</th>
				<th>Not Found</th>
			</tr>
		</thead>
		<tbody>

<tr id=1><td>48612</td><td>Technician</td><td>DVR High Def</td><td>CCP170527103750</td><td>26</td><td><input type="checkbox" class="checkbox"></td></tr>
<tr id=2><td>48612</td><td>Technician</td><td>DVR High Def</td><td>CCP180901100296</td><td>26</td><td><input type="checkbox" class="checkbox"></td></tr>
<tr id=3><td>48612</td><td>Technician</td><td>DVR MR HD IP</td><td>F11TDF645</td><td>26</td><td><input type="checkbox" class="checkbox"></td></tr>
<tr id=4><td>48612</td><td>Technician</td><td>DVR MultiRoom High Def</td><td>SACCJJSBM</td><td>26</td><td><input type="checkbox" class="checkbox"></td></tr>
<tr id=5><td>48612</td><td>Technician</td><td>DVR MultiRoom High Def</td><td>SACHJSDGR</td><td>26</td><td><input type="checkbox" class="checkbox"></td></tr>
		</tbody>
  </table>
  </form>
</section>

	<script>
	function myFunc() {
		const table = document.getElementsByClassName('order-table');
		const tRows = table[0].rows;
		const checkbox = document.getElementsByClassName('checkbox');
		const cpeList = [];
		for (let i = 1; i < (tRows.length); i++) {
			const techID = document.getElementById(i).firstChild.innerHTML;
			const serial = document.getElementById(i).children[3].innerHTML;
			if (checkbox[i-1].checked) {
				cpeList.push(document.getElementsByClassName('light-table-filter')[0].value);	
			} else {
			    cpeList.push(`techID:${techID} serial#${serial}`);
			}
		}
    // console.log(cpeList);
    		document.getElementsByClassName('myInput')[0].value = cpeList;
		document.getElementById("myForm").submit()
	}
	</script>
	<script type="text/javascript" src="scripts.js"></script>
	
	</body>
</html>
